---
title: "Agrupamento e filtragem"
description: "Tags de contêiner, filtros de metadata e técnicas avançadas de filtragem de pesquisa"
icon: "filter"
---

O Supermemory oferece suporte à filtragem de resultados de pesquisa usando tags de contêiner, condições de metadata e técnicas avançadas de filtragem nos endpoints `/v3/search` e `/v4/search`.

<div id="container-tags">
  ## Tags de contêiner
</div>

As tags de contêiner agrupam memórias por usuário, projeto ou organização. Elas são a principal forma de isolar resultados de busca.

**Importante**: As tags de contêiner usam **correspondência exata de array**. Um documento com `["technology", "quantum-computing"]` NÃO corresponderá a uma busca por `["technology"]`. Os arrays devem ser idênticos.

<div id="document-search-v3search">
  ### Busca em Documents (v3/search)
</div>

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    // Tag de container única
    const results = await client.search.documents({
      q: "machine learning",
      containerTags: ["user_123"],
      limit: 10
    });

    // Múltiplas tags de container
    const results2 = await client.search.documents({
      q: "project status",
      containerTags: ["project_ai", "team_research"],
      limit: 10
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    # Tag de container única
    results = client.search.documents(
        q="machine learning",
        container_tags=["user_123"],
        limit=10
    )

    # Múltiplas tags de container
    results2 = client.search.documents(
        q="project status",
        container_tags=["project_ai", "team_research"],
        limit=10
    )
    ```
  </Tab>
  <Tab title="cURL">
    ```bash
    # Tag de container única
    curl -X POST "https://api.supermemory.ai/v3/search" \
      -H "Authorization: Bearer $SUPERMEMORY_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "q": "machine learning",
        "containerTags": ["user_123"],
        "limit": 10
      }'
    ```
  </Tab>
</Tabs>

<div id="memory-search-v4search">
  ### Busca de memórias (/v4/search)
</div>

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    // Observação: "containerTag" no singular para v4/search
    const results = await client.search.memories({
      q: "research findings",
      containerTag: "user_123",  // String única, não array
      limit: 5
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    # Observação: "container_tag" no singular para v4/search
    results = client.search.memories(
        q="research findings",
        container_tag="user_123",  # String única, não array
        limit=5
    )
    ```
  </Tab>
  <Tab title="cURL">
    ```bash
    curl -X POST "https://api.supermemory.ai/v4/search" \
      -H "Authorization: Bearer $SUPERMEMORY_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "q": "research findings",
        "containerTag": "user_123",
        "limit": 5
      }'
    ```
  </Tab>
</Tabs>

<Note>
**Diferenças de container tag**:
- `/v3/search` usa `containerTags` (array no plural) com correspondência exata do array
- `/v4/search` usa `containerTag` (string no singular) para filtragem por uma única tag
- Correspondência exata significa `["user", "project"]` ≠ `["user"]`
</Note>

<div id="basic-metadata-filtering">
  ## Filtragem básica por metadata
</div>

Filtre por campos de metadata com condições simples:

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    const results = await client.search.documents({
      q: "artificial intelligence",
      filters: {
        AND: [
          {
            key: "category",
            value: "technology",
            negate: false
          }
        ]
      },
      limit: 10
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    results = client.search.documents(
        q="artificial intelligence",
        filters={
            "AND": [
                {
                    "key": "category",
                    "value": "technology",
                    "negate": False
                }
            ]
        },
        limit=10
    )
    ```
  </Tab>
  <Tab title="cURL">
    ```bash
    curl -X POST "https://api.supermemory.ai/v3/search" \
      -H "Authorization: Bearer $SUPERMEMORY_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "q": "artificial intelligence",
        "filters": {
          "AND": [
            {
              "key": "category",
              "value": "technology",
              "negate": false
            }
          ]
        },
        "limit": 10
      }'
    ```
  </Tab>
</Tabs>

<div id="numeric-filtering">
  ## Filtragem numérica
</div>

Filtre por valores numéricos usando operadores:

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    const results = await client.search.documents({
      q: "research papers",
      filters: {
        AND: [
          {
            filterType: "numeric",
            key: "readingTime",
            value: "10",
            numericOperator: "<=",
            negate: false
          },
          {
            filterType: "numeric",
            key: "wordCount",
            value: "1000",
            numericOperator: ">=",
            negate: false
          }
        ]
      },
      limit: 10
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    results = client.search.documents(
        q="research papers",
        filters={
            "AND": [
                {
                    "filterType": "numeric",
                    "key": "readingTime",
                    "value": "10",
                    "numericOperator": "<=",
                    "negate": False
                },
                {
                    "filterType": "numeric",
                    "key": "wordCount",
                    "value": "1000",
                    "numericOperator": ">=",
                    "negate": False
                }
            ]
        },
        limit=10
    )
    ```
  </Tab>
  <Tab title="cURL">
    ```bash
    curl -X POST "https://api.supermemory.ai/v3/search" \
      -H "Authorization: Bearer $SUPERMEMORY_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "q": "research papers",
        "filters": {
          "AND": [
            {
              "filterType": "numeric",
              "key": "readingTime",
              "value": "10",
              "numericOperator": "<=",
              "negate": false
            },
            {
              "filterType": "numeric",
              "key": "wordCount",
              "value": "1000",
              "numericOperator": ">=",
              "negate": false
            }
          ]
        },
        "limit": 10
      }'
    ```
  </Tab>
</Tabs>

<div id="array-contains-filtering">
  ## Filtragem com Array Contains
</div>

Filtre por valores em arrays, como participantes, tags ou categorias. O tipo de filtro `array_contains` verifica se um campo de array contém um valor específico.

<div id="basic-array-contains">
  ### array_contains básico
</div>

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    const results = await client.search.documents({
      q: "notas de reunião",
      filters: {
        AND: [
          {
            key: "participants",
            value: "john.doe",
            filterType: "array_contains"
          }
        ]
      },
      limit: 10
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    results = client.search.documents(
        q="notas de reunião",
        filters={
            "AND": [
                {
                    "key": "participants",
                    "value": "john.doe",
                    "filterType": "array_contains"
                }
            ]
        },
        limit=10
    )
    ```
  </Tab>
  <Tab title="cURL">
    ```bash
    curl -X POST "https://api.supermemory.ai/v3/search" \
      -H "Authorization: Bearer $SUPERMEMORY_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "q": "notas de reunião",
        "filters": {
          "AND": [
            {
              "key": "participants",
              "value": "john.doe",
              "filterType": "array_contains"
            }
          ]
        },
        "limit": 10
      }'
    ```
  </Tab>
</Tabs>

<div id="array-contains-with-negation">
  ### array_contains com negação
</div>

Exclua documents que contêm valores específicos em arrays:

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    const results = await client.search.documents({
      q: "reuniões de equipe",
      filters: {
        AND: [
          {
            key: "participants",
            value: "john.doe",
            filterType: "array_contains",
            negate: true  // Excluir reuniões com john.doe
          }
        ]
      },
      limit: 10
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    results = client.search.documents(
        q="reuniões de equipe",
        filters={
            "AND": [
                {
                    "key": "participants",
                    "value": "john.doe",
                    "filterType": "array_contains",
                    "negate": True  # Excluir reuniões com john.doe
                }
            ]
        },
        limit=10
    )
    ```
  </Tab>
  <Tab title="cURL">
    ```bash
    curl -X POST "https://api.supermemory.ai/v3/search" \
      -H "Authorization: Bearer $SUPERMEMORY_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "q": "reuniões de equipe",
        "filters": {
          "AND": [
            {
              "key": "participants",
              "value": "john.doe",
              "filterType": "array_contains",
              "negate": true
            }
          ]
        },
        "limit": 10
      }'
    ```
  </Tab>
</Tabs>

<div id="multiple-array-contains-conditions">
  ### Várias condições de array_contains
</div>

Encontre documentos com vários participantes obrigatórios:

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    const results = await client.search.documents({
      q: "project planning",
      filters: {
        AND: [
          {
            key: "participants",
            value: "project.manager",
            filterType: "array_contains"
          },
          {
            key: "participants",
            value: "lead.developer",
            filterType: "array_contains"
          },
          {
            key: "tags",
            value: "urgent",
            filterType: "array_contains"
          }
        ]
      },
      limit: 10
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    results = client.search.documents(
        q="project planning",
        filters={
            "AND": [
                {
                    "key": "participants",
                    "value": "project.manager",
                    "filterType": "array_contains"
                },
                {
                    "key": "participants",
                    "value": "lead.developer",
                    "filterType": "array_contains"
                },
                {
                    "key": "tags",
                    "value": "urgent",
                    "filterType": "array_contains"
                }
            ]
        },
        limit=10
    )
    ```
  </Tab>
  <Tab title="cURL">
    ```bash
    curl -X POST "https://api.supermemory.ai/v3/search" \
      -H "Authorization: Bearer $SUPERMEMORY_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "q": "project planning",
        "filters": {
          "AND": [
            {
              "key": "participants",
              "value": "project.manager",
              "filterType": "array_contains"
            },
            {
              "key": "participants",
              "value": "lead.developer",
              "filterType": "array_contains"
            },
            {
              "key": "tags",
              "value": "urgent",
              "filterType": "array_contains"
            }
          ]
        },
        "limit": 10
      }'
    ```
  </Tab>
</Tabs>

<div id="array-contains-with-or-logic">
  ### array_contains com lógica OR
</div>

Encontre documentos que tenham qualquer um entre vários participantes:

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    const results = await client.search.documents({
      q: "weekly reports",
      filters: {
        OR: [
          {
            key: "reviewers",
            value: "senior.manager",
            filterType: "array_contains"
          },
          {
            key: "reviewers",
            value: "department.head",
            filterType: "array_contains"
          },
          {
            key: "reviewers",
            value: "project.lead",
            filterType: "array_contains"
          }
        ]
      },
      limit: 15
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    results = client.search.documents(
        q="weekly reports",
        filters={
            "OR": [
                {
                    "key": "reviewers",
                    "value": "senior.manager",
                    "filterType": "array_contains"
                },
                {
                    "key": "reviewers",
                    "value": "department.head",
                    "filterType": "array_contains"
                },
                {
                    "key": "reviewers",
                    "value": "project.lead",
                    "filterType": "array_contains"
                }
            ]
        },
        limit=15
    )
    ```
  </Tab>
  <Tab title="cURL">
    ```bash
    curl -X POST "https://api.supermemory.ai/v3/search" \
      -H "Authorization: Bearer $SUPERMEMORY_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "q": "weekly reports",
        "filters": {
          "OR": [
            {
              "key": "reviewers",
              "value": "senior.manager",
              "filterType": "array_contains"
            },
            {
              "key": "reviewers",
              "value": "department.head",
              "filterType": "array_contains"
            },
            {
              "key": "reviewers",
              "value": "project.lead",
              "filterType": "array_contains"
            }
          ]
        },
        "limit": 15
      }'
    ```
  </Tab>
</Tabs>

<div id="or-conditions">
  ## Condições OR
</div>

Combine várias condições usando a lógica OR:

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    const results = await client.search.documents({
      q: "technology updates",
      filters: {
        OR: [
          {
            key: "category",
            value: "ai",
            negate: false
          },
          {
            key: "category",
            value: "machine-learning",
            negate: false
          },
          {
            key: "topic",
            value: "neural-networks",
            negate: false
          }
        ]
      },
      limit: 10
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    results = client.search.documents(
        q="technology updates",
        filters={
            "OR": [
                {
                    "key": "category",
                    "value": "ai",
                    "negate": False
                },
                {
                    "key": "category",
                    "value": "machine-learning",
                    "negate": False
                },
                {
                    "key": "topic",
                    "value": "neural-networks",
                    "negate": False
                }
            ]
        },
        limit=10
    )
    ```
  </Tab>
  <Tab title="cURL">
    ```bash
    curl -X POST "https://api.supermemory.ai/v3/search" \
      -H "Authorization: Bearer $SUPERMEMORY_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "q": "technology updates",
        "filters": {
          "OR": [
            {
              "key": "category",
              "value": "ai",
              "negate": false
            },
            {
              "key": "category",
              "value": "machine-learning",
              "negate": false
            },
            {
              "key": "topic",
              "value": "neural-networks",
              "negate": false
            }
          ]
        },
        "limit": 10
      }'
    ```
  </Tab>
</Tabs>

<div id="complex-nested-conditions">
  ## Condições Complexas Aninhadas
</div>

Combine a lógica AND e OR para filtragem avançada:

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    const results = await client.search.documents({
      q: "research publications",
      filters: {
        AND: [
          {
            key: "status",
            value: "published",
            negate: false
          },
          {
            OR: [
              {
                key: "category",
                value: "ai",
                negate: false
              },
              {
                key: "category",
                value: "machine-learning",
                negate: false
              }
            ]
          },
          {
            filterType: "numeric",
            key: "year",
            value: "2023",
            numericOperator: ">=",
            negate: false
          }
        ]
      },
      limit: 15
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    results = client.search.documents(
        q="research publications",
        filters={
            "AND": [
                {
                    "key": "status",
                    "value": "published",
                    "negate": False
                },
                {
                    "OR": [
                        {
                            "key": "category",
                            "value": "ai",
                            "negate": False
                        },
                        {
                            "key": "category",
                            "value": "machine-learning",
                            "negate": False
                        }
                    ]
                },
                {
                    "filterType": "numeric",
                    "key": "year",
                    "value": "2023",
                    "numericOperator": ">=",
                    "negate": False
                }
            ]
        },
        limit=15
    )
    ```
  </Tab>
  <Tab title="cURL">
    ```bash
    curl -X POST "https://api.supermemory.ai/v3/search" \
      -H "Authorization: Bearer $SUPERMEMORY_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "q": "research publications",
        "filters": {
          "AND": [
            {
              "key": "status",
              "value": "published",
              "negate": false
            },
            {
              "OR": [
                {
                  "key": "category",
                  "value": "ai",
                  "negate": false
                },
                {
                  "key": "category",
                  "value": "machine-learning",
                  "negate": false
                }
              ]
            },
            {
              "filterType": "numeric",
              "key": "year",
              "value": "2023",
              "numericOperator": ">=",
              "negate": false
            }
          ]
        },
        "limit": 15
      }'
    ```
  </Tab>
</Tabs>

<div id="negation-filters">
  ## Filtros de negação
</div>

Exclua valores específicos usando negação:

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    const results = await client.search.documents({
      q: "machine learning",
      filters: {
        AND: [
          {
            key: "category",
            value: "ai",
            negate: false
          },
          {
            key: "status",
            value: "draft",
            negate: true  // Excluir rascunhos
          },
          {
            key: "author",
            value: "deprecated_user",
            negate: true  // Excluir autor específico
          }
        ]
      },
      limit: 10
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    results = client.search.documents(
        q="machine learning",
        filters={
            "AND": [
                {
                    "key": "category",
                    "value": "ai",
                    "negate": False
                },
                {
                    "key": "status",
                    "value": "draft",
                    "negate": True  # Excluir rascunhos
                },
                {
                    "key": "author",
                    "value": "deprecated_user",
                    "negate": True  # Excluir autor específico
                }
            ]
        },
        limit=10
    )
    ```
  </Tab>
  <Tab title="cURL">
    ```bash
    curl -X POST "https://api.supermemory.ai/v3/search" \
      -H "Authorization: Bearer $SUPERMEMORY_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "q": "machine learning",
        "filters": {
          "AND": [
            {
              "key": "category",
              "value": "ai",
              "negate": false
            },
            {
              "key": "status",
              "value": "draft",
              "negate": true
            },
            {
              "key": "author",
              "value": "deprecated_user",
              "negate": true
            }
          ]
        },
        "limit": 10
      }'
    ```
  </Tab>
</Tabs>

<div id="document-specific-search">
  ## Pesquisa específica em um documento
</div>

Pesquise dentro de um documento específico:

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    const results = await client.search.documents({
      q: "neural network architecture",
      docId: "doc_large_textbook_123",  // Pesquisar apenas neste documento
      limit: 20
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    results = client.search.documents(
        q="neural network architecture",
        doc_id="doc_large_textbook_123",  # Pesquisar apenas neste documento
        limit=20
    )
    ```
  </Tab>
  <Tab title="cURL">
    ```bash
    curl -X POST "https://api.supermemory.ai/v3/search" \
      -H "Authorization: Bearer $SUPERMEMORY_API_KEY" \
      -H "Content-Type: application/json" \
      -d '{
        "q": "neural network architecture",
        "docId": "doc_large_textbook_123",
        "limit": 20
      }'
    ```
  </Tab>
</Tabs>

<div id="filter-best-practices">
  ## Melhores práticas de filtros
</div>

<Callout type="info">
**Dicas de desempenho**:
- Use tags de contêiner como filtro principal (mais rápido)
- Combine com filtros simples de metadata para maior precisão
- Evite condições OR aninhadas complexas para melhor desempenho
- Use operadores numéricos apenas quando necessário
</Callout>

<Warning>
**Estrutura de filtros**: Todas as condições devem estar dentro de arrays `AND` ou `OR`. Mesmo uma condição única precisa do wrapper de array: `{"AND": [{"key": "category", "value": "ai"}]}`.
</Warning>

<Note>
**Operadores compatíveis**:
- **String**: Apenas correspondência exata
- **Numérico**: `<=`, `>=`, `<`, `>`, `=`
- **Array**: `array_contains` para verificar se o array contém um valor
- **Negação**: Funciona com todos os tipos de filtro
</Note>

<div id="common-filter-patterns">
  ## Padrões comuns de filtros
</div>

<div id="user-specific-content">
  ### Conteúdo específico do usuário
</div>

```json
{
  "containerTags": ["user_123"],
  "filters": {
    "AND": [
      {"key": "visibility", "value": "private", "negate": false}
    ]
  }
}
```


<div id="recent-high-quality-content">
  ### Conteúdo recente de alta qualidade
</div>

```json
{
  "filters": {
    "AND": [
      {
        "filterType": "numeric",
        "key": "created_year",
        "value": "2024",
        "numericOperator": ">="
      },
      {
        "filterType": "numeric",
        "key": "quality_score",
        "value": "7",
        "numericOperator": ">="
      }
    ]
  }
}
```


<div id="multi-category-search">
  ### Pesquisa Multicategoria
</div>

```json
{
  "filters": {
    "OR": [
      {"key": "category", "value": "ai"},
      {"key": "category", "value": "machine-learning"},
      {"key": "category", "value": "data-science"}
    ]
  }
}
```


<div id="team-member-participation">
  ### Participação de membros da equipe
</div>

```json
{
  "filters": {
    "AND": [
      {
        "key": "participants",
        "value": "team.lead",
        "filterType": "array_contains"
      },
      {
        "key": "project_tags",
        "value": "high-priority",
        "filterType": "array_contains"
      }
    ]
  }
}
```


<div id="exclude-specific-teams">
  ### Excluir equipes específicas
</div>

```json
{
  "filters": {
    "AND": [
      {
        "key": "department",
        "value": "marketing",
        "filterType": "array_contains",
        "negate": true
      },
      {
        "key": "confidential_tags",
        "value": "executive-only",
        "filterType": "array_contains",
        "negate": true
      }
    ]
  }
}
```


<div id="complex-meeting-filter">
  ### Filtro de Reuniões Complexas
</div>

```json
{
  "filters": {
    "AND": [
      {
        "OR": [
          {
            "key": "attendees",
            "value": "ceo",
            "filterType": "array_contains"
          },
          {
            "key": "attendees",
            "value": "cto",
            "filterType": "array_contains"
          }
        ]
      },
      {
        "key": "meeting_type",
        "value": "cancelled",
        "negate": true
      },
      {
        "filterType": "numeric",
        "key": "duration_minutes",
        "value": "30",
        "numericOperator": ">="
      }
    ]
  }
}
```
